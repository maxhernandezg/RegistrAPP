"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4254],{4254:(w,g,c)=>{c.r(g),c.d(g,{DocenteHomePageModule:()=>x});var m=c(177),s=c(4742),u=c(5559),C=c(467),e=c(4438),p=c(671);let F=(()=>{var n;class r{constructor(o,t,a,l){var d;this.router=o,this.menu=t,this.authService=a,this.toastController=l,this.userName="Docente",this.currentSegment="clases";const h=this.router.getCurrentNavigation(),_=null==h||null===(d=h.extras)||void 0===d?void 0:d.state;_&&(this.userName=_.user.fullName)}ngOnInit(){}ionViewWillEnter(){const o=this.authService.getCurrentUser();this.userName=o?o.fullName:"Docente"}openMenu(){this.menu.open("end")}segmentChanged(o){var t;const a=(null===(t=o.detail)||void 0===t?void 0:t.value)||o;this.currentSegment=a,this.router.navigate([`/docente-home/${a}`])}logout(){var o=this;return(0,C.A)(function*(){o.authService.logout(),o.userName="Docente",(yield o.toastController.create({message:"Sesi\xf3n cerrada con \xe9xito",duration:2e3,position:"bottom"})).present(),o.router.navigate(["/login"])})()}}return(n=r).\u0275fac=function(o){return new(o||n)(e.rXU(u.Ix),e.rXU(s._t),e.rXU(p.u),e.rXU(s.K_))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-docente-home"]],decls:30,vars:1,consts:[["side","start","content-id","main-content","color","light"],["color","light"],[2,"display","flex","justify-content","center","align-items","center","width","100%"],["src","assets/logo3registrapp.png",2,"width","200px","height","auto","padding-top","10px","padding-bottom","10px"],["color","light",1,"ion-text-center"],["color","secondary","shape","round",2,"padding-top","20px",3,"click"],[2,"color","white","padding-top","12px"],["color","secondary"],["slot","start"],[3,"click"],["name","menu","color","light"],["color","light",1,"ion-text-center",2,"font-size","15px"],["id","main-content","color","light"],["value","clases","slot","fixed",3,"ionChange"],["value","clases"],["name","briefcase-outline","color","secondary"],["value","registro-asistencia"],["name","qr-code-outline","color","secondary"],["value","perfil-docente"],["name","person-circle-outline","color","secondary"],[2,"margin-top","40px"]],template:function(o,t){1&o&&(e.j41(0,"ion-app")(1,"ion-menu",0)(2,"ion-header")(3,"ion-toolbar",1)(4,"div",2),e.nrm(5,"ion-img",3),e.k0s()()(),e.j41(6,"ion-content",4)(7,"ion-button",5),e.bIt("click",function(){return t.logout()}),e.j41(8,"p",6)(9,"strong"),e.EFF(10,"Cerrar Sesi\xf3n"),e.k0s()()()()(),e.j41(11,"ion-header")(12,"ion-toolbar",7)(13,"ion-buttons",8)(14,"ion-button",9),e.bIt("click",function(){return t.openMenu()}),e.nrm(15,"ion-icon",10),e.k0s()(),e.j41(16,"ion-title",11)(17,"div"),e.EFF(18," Bienvenido/a "),e.k0s(),e.j41(19,"div"),e.EFF(20),e.k0s()()()(),e.j41(21,"ion-content",12)(22,"ion-segment",13),e.bIt("ionChange",function(l){return t.segmentChanged(l)}),e.j41(23,"ion-segment-button",14),e.nrm(24,"ion-icon",15),e.k0s(),e.j41(25,"ion-segment-button",16),e.nrm(26,"ion-icon",17),e.k0s(),e.j41(27,"ion-segment-button",18),e.nrm(28,"ion-icon",19),e.k0s()(),e.nrm(29,"ion-router-outlet",20),e.k0s()()),2&o&&(e.R7$(20),e.SpI(" ",t.userName," "))},dependencies:[s.U1,s.Jm,s.QW,s.W9,s.eU,s.iq,s.KW,s.oS,s.Gp,s.eP,s.BC,s.ai,s.Je,s.Rg]}),r})();var v=c(7783),f=c(9417);function D(n,r){1&n&&(e.j41(0,"span"),e.EFF(1,", "),e.k0s())}function k(n,r){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.DNE(2,D,2,0,"span",16),e.k0s()),2&n){const i=r.$implicit,o=e.XpG().$implicit,t=e.XpG();e.R7$(),e.SpI(" ",t.getTimeBlock(i)," "),e.R7$(),e.Y8G("ngIf",!t.isLastBlock(o.timeBlockIds,i))}}function y(n,r){if(1&n){const i=e.RV6();e.j41(0,"ion-item",0)(1,"ion-label",1)(2,"p",12)(3,"strong"),e.EFF(4),e.k0s()(),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8,"Horarios: "),e.DNE(9,k,3,2,"span",13),e.k0s()(),e.j41(10,"ion-button",14),e.bIt("click",function(){const t=e.eBV(i).$implicit,a=e.XpG();return e.Njj(a.generateQR(t.id))}),e.j41(11,"p",15),e.EFF(12,"Generar QR"),e.k0s()()()}if(2&n){const i=r.$implicit;e.R7$(4),e.JRh(i.className),e.R7$(2),e.SpI("Sala: ",i.classroomCode,""),e.R7$(3),e.Y8G("ngForOf",i.timeBlockIds)}}function I(n,r){if(1&n&&(e.j41(0,"ion-select-option",17),e.EFF(1),e.k0s()),2&n){const i=r.$implicit;e.Y8G("value",i.id),e.R7$(),e.Lme(" ",i.code," - ",i.name," ")}}function b(n,r){if(1&n&&(e.j41(0,"ion-select-option",17),e.EFF(1),e.k0s()),2&n){const i=r.$implicit;e.Y8G("value",i.id),e.R7$(),e.Lme(" ",i.startTime," - ",i.endTime," ")}}function E(n,r){if(1&n){const i=e.RV6();e.j41(0,"ion-item",0)(1,"ion-label",5)(2,"strong"),e.EFF(3),e.k0s()(),e.j41(4,"ion-select",18),e.mxI("ngModelChange",function(t){const a=e.eBV(i).$implicit,l=e.XpG();return e.DH7(l.schedule[a.id],t)||(l.schedule[a.id]=t),e.Njj(t)}),e.DNE(5,b,2,3,"ion-select-option",8),e.k0s()()}if(2&n){const i=r.$implicit,o=e.XpG();e.R7$(3),e.JRh(i.name),e.R7$(),e.R50("ngModel",o.schedule[i.id]),e.R7$(),e.Y8G("ngForOf",o.timeBlocks)}}let R=(()=>{var n;class r{constructor(o,t,a,l){this.apiService=o,this.router=t,this.authService=a,this.toastController=l,this.clases=[],this.filteredClases=[],this.classrooms=[],this.selectedClass=null,this.newClass={className:"",teacherId:null,schedule:[]},this.teacherId=null,this.todayName="",this.days=[],this.timeBlocks=[],this.schedule={},this.availableDays=[{id:0,name:"Domingo"},{id:1,name:"Lunes"},{id:2,name:"Martes"},{id:3,name:"Mi\xe9rcoles"},{id:4,name:"Jueves"},{id:5,name:"Viernes"},{id:6,name:"S\xe1bado"}],this.qrCodeData=""}ngOnInit(){this.initializeTeacherId(),this.loadClasses(),this.loadClassrooms(),this.setTodayName(),this.loadDays(),this.loadTimeBlocks()}setTodayName(){this.todayName=["Domingo","Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado"][(new Date).getDay()]}getDayName(o){return["Domingo","Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado"][o]||"D\xeda desconocido"}getTimeBlock(o){const t=this.timeBlocks.find(a=>a.id===o);return t?`${t.startTime} - ${t.endTime}`:"Bloque desconocido"}loadTimeBlocks(){this.apiService.getTimeBlocks().subscribe({next:o=>{this.timeBlocks=o.map(t=>({...t,id:Number(t.id)})),console.log("Bloques horarios cargados:",this.timeBlocks)},error:o=>{console.error("Error al cargar bloques horarios:",o),this.presentToast("Error al cargar bloques horarios")}})}loadClasses(){this.teacherId?this.apiService.getClassesByTeacher(this.teacherId).subscribe({next:o=>{this.clases=o.map(t=>(t.schedule.forEach(a=>{a.timeBlockIds=a.timeBlockIds.map(l=>Number(l))}),t)),this.filterClassesByToday()},error:o=>{console.error("Error al cargar clases:",o),this.presentToast("Error al cargar clases")}}):console.error("No se pudo cargar el teacherId del usuario.")}filterClassesByToday(){const o=(new Date).getDay();this.todayName=this.availableDays[o].name,this.filteredClases=this.clases.filter(t=>t.schedule.some(a=>a.dayId===o)),this.filteredClases.forEach(t=>{const a=t.schedule.find(d=>d.dayId===o);t.timeBlockIds=(null==a?void 0:a.timeBlockIds)||[];const l=this.classrooms.find(d=>d.id==t.classroomId);t.classroomCode=l?`${l.code} - ${l.name}`:"Sin sala"})}isLastBlock(o,t){return o[o.length-1]===t}loadDays(){this.apiService.getDays().subscribe({next:o=>{this.days=o},error:o=>{console.error("Error al cargar d\xedas:",o)}})}initializeTeacherId(){const o=this.authService.getCurrentUser();o&&"docente"===o.role?(this.teacherId=Number(o.id),this.newClass.teacherId=this.teacherId):(console.error("Usuario no autorizado o no es docente."),this.presentToast("Acceso denegado: No tienes permisos para ver esta p\xe1gina."))}loadClassrooms(){this.apiService.getClassrooms().subscribe({next:o=>{this.classrooms=o,this.updateClassroomsForClasses()},error:o=>{console.error("Error al cargar aulas:",o),this.presentToast("Error al cargar aulas")}})}updateClassroomsForClasses(){this.clases.length>0&&this.classrooms.length>0&&this.clases.forEach(o=>{const t=this.classrooms.find(a=>a.id===o.classroomId);o.classroomCode=t?`${t.code} - ${t.name}`:"Sin sala asignada"})}generateQR(o){const t={classId:o,timestamp:(new Date).toISOString(),token:"secureToken123"},a=JSON.stringify(t);this.router.navigate(["/docente-home/registro-asistencia"],{state:{qrCodeData:a}})}createClass(){""!==this.newClass.className.trim()?(this.newClass.schedule=Object.keys(this.schedule).map(o=>({dayId:parseInt(o,10),timeBlockIds:this.schedule[o].map(t=>parseInt(t,10))})),this.apiService.createClass(this.newClass).subscribe({next:()=>{this.presentToast("Clase creada exitosamente"),this.loadClasses(),this.newClass={className:"",teacherId:this.teacherId},this.schedule={}},error:o=>{console.error("Error al crear clase:",o),this.presentToast("Error al crear clase")}})):this.presentToast("El nombre de la clase no puede estar vac\xedo")}presentToast(o){var t=this;return(0,C.A)(function*(){(yield t.toastController.create({message:o,duration:2e3})).present()})()}}return(n=r).\u0275fac=function(o){return new(o||n)(e.rXU(v.G),e.rXU(u.Ix),e.rXU(p.u),e.rXU(s.K_))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-clases"]],decls:33,vars:6,consts:[["color","light"],["color","secondary"],["color","light",1,"ion-padding","ion-text-center"],[2,"font-size","15px","color","white"],["color","light",4,"ngFor","ngForOf"],["position","stacked","color","secondary"],["placeholder","Ingresa el nombre de la clase",2,"color","#833050",3,"ngModelChange","ngModel"],[2,"color","#833050",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[2,"display","flex","justify-content","center","align-items","center","width","100%"],["color","secondary","shape","round",2,"padding-top","20px",3,"click"],[2,"color","white","padding-top","12px"],[2,"font-size","20px"],[4,"ngFor","ngForOf"],["color","secondary",3,"click"],[2,"color","white","padding-top","10px"],[4,"ngIf"],[3,"value"],["multiple","true","placeholder","Selecciona bloques horarios",2,"color","#833050",3,"ngModelChange","ngModel"]],template:function(o,t){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e.EFF(3,"Clases del D\xeda de Hoy"),e.k0s()()(),e.j41(4,"ion-content",2)(5,"ion-card",1)(6,"ion-card-header")(7,"ion-card-title",3),e.EFF(8),e.k0s()()(),e.j41(9,"ion-list"),e.DNE(10,y,13,3,"ion-item",4),e.k0s(),e.j41(11,"ion-content",0)(12,"ion-list")(13,"ion-list-header",0)(14,"ion-label",1),e.EFF(15,"Crear Nueva Clase"),e.k0s()(),e.j41(16,"ion-item",0)(17,"ion-label",5)(18,"strong"),e.EFF(19,"Nombre de la Clase"),e.k0s()(),e.j41(20,"div")(21,"ion-input",6),e.mxI("ngModelChange",function(l){return e.DH7(t.newClass.className,l)||(t.newClass.className=l),l}),e.k0s()()(),e.j41(22,"ion-item",0)(23,"ion-label",5)(24,"strong"),e.EFF(25,"Sala"),e.k0s()(),e.j41(26,"ion-select",7),e.mxI("ngModelChange",function(l){return e.DH7(t.newClass.classroomId,l)||(t.newClass.classroomId=l),l}),e.DNE(27,I,2,3,"ion-select-option",8),e.k0s()(),e.DNE(28,E,6,3,"ion-item",4),e.j41(29,"div",9)(30,"ion-button",10),e.bIt("click",function(){return t.createClass()}),e.j41(31,"p",11),e.EFF(32,"Crear Clase"),e.k0s()()()()()()),2&o&&(e.R7$(8),e.SpI(" D\xeda de Hoy: ",t.todayName," "),e.R7$(2),e.Y8G("ngForOf",t.filteredClases),e.R7$(11),e.R50("ngModel",t.newClass.className),e.R7$(5),e.R50("ngModel",t.newClass.classroomId),e.R7$(),e.Y8G("ngForOf",t.classrooms),e.R7$(),e.Y8G("ngForOf",t.availableDays))},dependencies:[m.Sq,m.bT,s.Jm,s.b_,s.ME,s.tN,s.W9,s.eU,s.$w,s.uz,s.he,s.nf,s.AF,s.Nm,s.Ip,s.BC,s.ai,s.Je,s.Gw,f.BC,f.vS]}),r})();var j=c(5398);function T(n,r){if(1&n&&(e.j41(0,"ion-card",1)(1,"ion-card-header")(2,"ion-card-title")(3,"p",4),e.EFF(4,"C\xf3digo QR Generado"),e.k0s()()(),e.j41(5,"ion-card-content",5),e.nrm(6,"qrcode",6),e.j41(7,"p"),e.EFF(8),e.k0s()()()),2&n){const i=e.XpG();e.R7$(6),e.Y8G("colorDark","#833050")("qrdata",i.qrCodeData)("width",256)("errorCorrectionLevel","M"),e.R7$(2),e.JRh(i.qrCodeData)}}function N(n,r){1&n&&(e.j41(0,"ion-card",1)(1,"p",7),e.EFF(2,"No se ha generado QR"),e.k0s()())}function M(n,r){1&n&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"No hay datos disponibles"),e.k0s()(),e.j41(4,"ion-card-content"),e.EFF(5," Parece que no hay datos del docente. Por favor, verifica tu sesi\xf3n. "),e.k0s()())}const B=[{path:"",component:F,children:[{path:"clases",component:R},{path:"registro-asistencia",component:(()=>{var n;class r{constructor(o){this.router=o,this.qrCodeData=""}ngOnInit(){var o;const t=this.router.getCurrentNavigation(),a=null==t||null===(o=t.extras)||void 0===o?void 0:o.state;this.qrCodeData=(null==a?void 0:a.qrCodeData)||""}}return(n=r).\u0275fac=function(o){return new(o||n)(e.rXU(u.Ix))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-registro-asistencia"]],decls:7,vars:2,consts:[["color","light"],["color","secondary"],["color","light",1,"ion-padding","ion-text-center"],["color","secondary",4,"ngIf"],[2,"color","white"],[1,"ion-text-center",2,"color","#833050"],[3,"colorDark","qrdata","width","errorCorrectionLevel"],[2,"color","white","padding-top","10px"]],template:function(o,t){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e.EFF(3,"Registro de Asistencia"),e.k0s()()(),e.j41(4,"ion-content",2),e.DNE(5,T,9,5,"ion-card",3)(6,N,3,0,"ion-card",3),e.k0s()),2&o&&(e.R7$(5),e.Y8G("ngIf",t.qrCodeData),e.R7$(),e.Y8G("ngIf",!t.qrCodeData))},dependencies:[m.bT,s.b_,s.I9,s.ME,s.tN,s.W9,s.eU,s.BC,s.ai,j.c]}),r})()},{path:"perfil-docente",component:(()=>{var n;class r{constructor(o){this.authService=o,this.docente=null}ngOnInit(){this.loadDocenteData()}loadDocenteData(){const o=this.authService.getCurrentUser();o&&"docente"===o.role?this.docente=o:console.warn("Usuario no autorizado o no es un docente.")}}return(n=r).\u0275fac=function(o){return new(o||n)(e.rXU(p.u))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-perfil-docente"]],decls:28,vars:5,consts:[["color","light"],["color","secondary"],["color","light",1,"ion-padding"],[2,"font-size","20px"],[4,"ngIf"]],template:function(o,t){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e.EFF(3,"Perfil Docente"),e.k0s()()(),e.j41(4,"ion-content",2)(5,"ion-list")(6,"ion-item",0)(7,"ion-label",1)(8,"p",3)(9,"strong"),e.EFF(10),e.k0s()(),e.j41(11,"p"),e.EFF(12),e.k0s()()(),e.j41(13,"ion-item",0)(14,"ion-label",1)(15,"p",3)(16,"strong"),e.EFF(17,"Email:"),e.k0s()(),e.j41(18,"ion-text"),e.EFF(19),e.k0s()()(),e.j41(20,"ion-item",0)(21,"ion-label",1)(22,"p",3)(23,"strong"),e.EFF(24,"ID de Usuario:"),e.k0s()(),e.j41(25,"ion-text"),e.EFF(26),e.k0s()()()(),e.DNE(27,M,6,0,"ion-card",4),e.k0s()),2&o&&(e.R7$(10),e.JRh(t.docente.fullName),e.R7$(2),e.JRh(t.docente.role.charAt(0).toUpperCase()+t.docente.role.slice(1).toLowerCase()),e.R7$(7),e.JRh(t.docente.email),e.R7$(7),e.JRh(t.docente.id),e.R7$(),e.Y8G("ngIf",!t.docente))},dependencies:[m.bT,s.b_,s.I9,s.ME,s.tN,s.W9,s.eU,s.uz,s.he,s.nf,s.IO,s.BC,s.ai]}),r})()},{path:"",redirectTo:"clases",pathMatch:"full"}]}];let S=(()=>{var n;class r{}return(n=r).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[u.iI.forChild(B),u.iI]}),r})(),x=(()=>{var n;class r{}return(n=r).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[m.MD,s.bv,S]}),r})()}}]);